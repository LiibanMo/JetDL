import torch

from tensorlite import Tensor

# Function(s) ------------------------------------------------------------------------

def compare_tensors(tensor1: torch.tensor, tensor2: torch.tensor, epsilon=1e-5) -> bool:
    diff = torch.abs(tensor1 - tensor2)
    return torch.all(diff < epsilon)


# Data  & IDs ------------------------------------------------------------------------

# matmul -----------------------------------------------------------------------------

matmul_data = [
    # 1D @ 1D
    ([1, 2, 3], [4, 5, 6]), 
    ([1], [2]), 
    # 1D @ 2D
    ([1, 2, 3], [[4, 5], [6, 7], [8, 9]]), 
    ([1, 1], [[1], [1]]), 
    # 1D @ 3D
    ([1, 2, 3], [[[1, 2], [3, 4]], [[5, 6], [7, 8]], [[9, 10], [11, 12]]]),
    ([1], [[[1]]]),
    # 2D @ 1D
    ([[1, 2], [3, 4]], [5, 6]),
    ([[1, 2], [3, 4]], [1, 1]),
    # 2D @ 2D
    ([[1, 2], [3, 4]], [[5, 6], [7, 8]]),
    ([[1, 0], [0, 1]], [[5, 6], [7, 8]]),
    # 2D @ 3D
    ([[1, 2], [3, 4]], [[[1, 2], [3, 4]], [[5, 6], [7, 8]]]),
    ([[1, 2]], [[[1, 2], [3, 4]]]),
    # 3D @ 1D
    ([[[1, 2], [3, 4]], [[5, 6], [7, 8]]], [1, 1]),
    ([[[1, 1]]], [1]),
    # 3D @ 2D
    ([[[1, 2], [3, 4]], [[5, 6], [7, 8]], [[9, 10], [11, 12]]], [[1, 2], [3, 4]]),
    ([[[1, 0], [0, 1]], [[1, 1], [1, 1]]], [[2, 3], [4, 5]]), 
    # 3D @ 3D
    ([[[1, 2], [3, 4]], [[5, 6], [7, 8]]], [[[1, 2], [3, 4]], [[5, 6], [7, 8]]]),  
    ([[[1, 0], [0, 1]], [[1, 1], [1, 1]]], [[[1, 0], [0, 1]], [[1, 1], [1, 1]]]),  
]

matmul_ids = [
    "1D @ 1D: Normal Case",
    "1D @ 1D: Edge Case",
    "1D @ 2D: Normal Case",
    "1D @ 2D: Edge Case",
    "1D @ 3D: Normal Case",
    "1D @ 3D: Edge Case",
    "2D @ 1D: Normal Case",
    "2D @ 1D: Edge Case",
    "2D @ 2D: Normal Case",
    "2D @ 2D: Edge Case",
    "2D @ 3D: Normal Case",
    "2D @ 3D: Edge Case",
    "3D @ 1D: Normal Case",
    "3D @ 1D: Edge Case",
    "3D @ 2D: Normal Case",
    "3D @ 2D: Edge Case",
    "3D @ 3D: Normal Case",
    "3D @ 3D: Edge Case",
]